{"version":3,"sources":["components/UploadButton/index.jsx","components/Loading/index.jsx","pages/utils.js","pages/TaskList/index.jsx","pages/Home/consts.jsx","pages/Home/index.jsx","pages/TaskEdit/index.jsx","routes.js","App.js","index.js"],"names":["UploadButton","upload","this","props","style","fontSize","RedoOutline","onClick","React","Component","LoadingMask","visible","className","showText","text","TaskList","state","data","loading","uploadData","bind","refreshList","itemClick","setState","item","history","push","objectId","AV","Query","find","then","result","map","value","toFullJSON","title","backArrow","right","onRefresh","length","Item","e","prefix","key_index","name","remark","extra","key_point_type","description","station_name","position","clickable","mile","padding","imageStyle","width","withRouter","tabs","key","icon","AppOutline","UnorderedListOutline","active","MessageFill","MessageOutline","UserOutline","Home","activeKey","tabChange","renderContent","t","onChange","TaskEdit","fileList","formRef","createRef","back","changeFileList","uploadFile","match","params","query","equalTo","console","log","current","setFieldsValue","go","file","reader","FileReader","readAsDataURL","Promise","resolve","reject","onload","target","url","onBack","ref","layout","marginTop","label","placeholder","type","autoSize","minRows","maxRows","routes","path","component","exact","init","appId","appKey","serverURL","App","route","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.dd3d9629.chunk.js","sourcesContent":["import { RedoOutline } from 'antd-mobile-icons';\nimport React from 'react';\n\nclass UploadButton extends React.Component {\n  render() {\n    const { upload } = this.props;\n    return (\n      <div style={{ fontSize: 18 }}>\n        <RedoOutline onClick={upload} />\n      </div>\n    );\n  }\n}\n\nexport default UploadButton;\n","import { Mask, Loading } from 'antd-mobile';\nimport React from 'react';\nimport './index.css';\n\nclass LoadingMask extends React.Component {\n  render() {\n    const { visible } = this.props;\n    return (\n      <Mask visible={visible}>\n        <div className=\"content\">\n          加载中\n          <Loading />\n        </div>\n      </Mask>\n    );\n  }\n}\n\nexport default LoadingMask;\n","export function showText(text) {\n  return text || '-';\n}\n","import { Empty, List, NavBar, PullToRefresh } from 'antd-mobile';\nimport AV from 'leancloud-storage/live-query';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { UploadButton, Loading } from '../../components';\nimport { showText } from '../utils';\n\nclass TaskList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      data: [],\n      loading: false,\n    };\n\n    this.uploadData = this.uploadData.bind(this);\n    this.refreshList = this.refreshList.bind(this);\n\n    this.itemClick = this.itemClick.bind(this);\n  }\n\n  componentDidMount() {\n    this.refreshList();\n  }\n\n  /**\n   * 上传同步数据\n   */\n  uploadData() {\n    this.setState({ loading: true });\n  }\n\n  itemClick(item) {\n    this.props.history.push(`/task/${item.objectId}`);\n  }\n\n  /**\n   * 刷新数据\n   */\n  refreshList() {\n    const query = new AV.Query('KeyPoint');\n    query.find().then((result) => {\n      const data = result.map((value) => value.toFullJSON());\n      this.setState({ data });\n    });\n  }\n\n  render() {\n    const { title } = this.props;\n    const { data, loading } = this.state;\n\n    return (\n      <>\n        <NavBar\n          className=\"nav-bar\"\n          backArrow={false}\n          right={<UploadButton upload={this.uploadData} />}\n        >\n          {title}\n        </NavBar>\n\n        <PullToRefresh onRefresh={this.refreshList}>\n          {data.length > 0 ? (\n            <List>\n              {data.map((item) => (\n                <List.Item\n                  onClick={(e) => this.itemClick(item)}\n                  key={item.objectId}\n                  prefix={item.key_index}\n                  title={`名称: ${showText(item.name)} (${showText(\n                    item.remark,\n                  )})`}\n                  extra={`${showText(item.key_point_type)}`}\n                  description={`车站: ${showText(\n                    item.station_name,\n                  )} 位置: ${showText(item.position)}CM`}\n                  clickable\n                >\n                  {`里程: ${item.mile}`}\n                </List.Item>\n              ))}\n            </List>\n          ) : (\n            <Empty\n              style={{ padding: '128px 0' }}\n              imageStyle={{ width: 128 }}\n              description=\"暂无数据\"\n            />\n          )}\n        </PullToRefresh>\n\n        <Loading visible={loading} />\n      </>\n    );\n  }\n}\n\nexport default withRouter(TaskList);\n","import {\n  AppOutline,\n  MessageFill,\n  MessageOutline,\n  UnorderedListOutline,\n  UserOutline,\n} from 'antd-mobile-icons';\n\nexport const tabs = [\n  {\n    key: 'home',\n    title: '首页',\n    icon: <AppOutline />,\n  },\n  {\n    key: 'todo',\n    title: '我的待办',\n    icon: <UnorderedListOutline />,\n  },\n  {\n    key: 'message',\n    title: '我的消息',\n    icon: (active) => (active ? <MessageFill /> : <MessageOutline />),\n  },\n  {\n    key: 'personalCenter',\n    title: '个人中心',\n    icon: <UserOutline />,\n  },\n];\n","import { TabBar } from 'antd-mobile';\nimport React from 'react';\nimport TaskList from '../TaskList';\nimport { tabs } from './consts';\n\nclass Home extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activeKey: 'todo',\n    };\n\n    this.tabChange = this.tabChange.bind(this);\n    this.renderContent = this.renderContent.bind(this);\n  }\n\n  tabChange(key) {\n    this.setState({ activeKey: key });\n  }\n\n  renderContent() {\n    const { activeKey } = this.state;\n    const title = tabs.find((t) => t.key === activeKey).title;\n    return activeKey === 'todo' ? <TaskList title={title} /> : null;\n  }\n\n  render() {\n    const { activeKey } = this.state;\n\n    return (\n      <>\n        <div className=\"tab-content\">{this.renderContent()}</div>\n\n        <TabBar\n          className=\"tab-bar\"\n          activeKey={activeKey}\n          onChange={this.tabChange}\n        >\n          {tabs.map((item) => (\n            <TabBar.Item\n              key={item.key}\n              icon={item.icon}\n              title={item.title}\n            />\n          ))}\n        </TabBar>\n      </>\n    );\n  }\n}\n\nexport default Home;\n","import {\n  Form,\n  ImageUploader,\n  Input,\n  NavBar,\n  TextArea,\n} from 'antd-mobile';\nimport AV from 'leancloud-storage/live-query';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Loading, UploadButton } from '../../components';\n\nclass TaskEdit extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      fileList: [],\n      loading: false,\n    };\n\n    this.formRef = React.createRef();\n\n    this.back = this.back.bind(this);\n    this.changeFileList = this.changeFileList.bind(this);\n    this.uploadFile = this.uploadFile.bind(this);\n    this.uploadData = this.uploadData.bind(this);\n  }\n\n  componentDidMount() {\n    const { objectId } = this.props.match.params;\n\n    const query = new AV.Query('KeyPoint');\n    query.equalTo('objectId', objectId);\n    query.find().then((result) => {\n      const data = result.map((value) => value.toFullJSON());\n\n      console.log(data[0]);\n      this.formRef.current?.setFieldsValue(data[0]);\n    });\n  }\n\n  back() {\n    this.props.history.go(-1);\n  }\n\n  /**\n   * 上传同步数据\n   */\n  uploadData() {\n    this.setState({ loading: true });\n  }\n\n  changeFileList(fileList) {\n    console.log(fileList);\n  }\n\n  uploadFile(file) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    return new Promise((resolve, reject) => {\n      reader.onload = (e) => {\n        console.log(e.target.result);\n        resolve({ url: e.target.result });\n      };\n    });\n  }\n\n  render() {\n    const { loading, fileList } = this.state;\n\n    return (\n      <>\n        <NavBar\n          className=\"nav-bar\"\n          onBack={this.back}\n          right={<UploadButton upload={this.uploadData} />}\n        >\n          修改关键点\n        </NavBar>\n\n        <Form\n          ref={this.formRef}\n          layout=\"horizontal\"\n          style={{ marginTop: '45px' }}\n        >\n          <Form.Item name=\"station_name\" label=\"车站\">\n            <Input placeholder=\"请输入车站\" />\n          </Form.Item>\n\n          <Form.Item name=\"key_point_type\" label=\"关键点\">\n            <Input placeholder=\"请输入关键点\" />\n          </Form.Item>\n\n          <Form.Item name=\"name\" label=\"名称\">\n            <Input placeholder=\"请输入名称\" />\n          </Form.Item>\n\n          <Form.Item name=\"type\" label=\"类型\">\n            <Input placeholder=\"请输入类型\" />\n          </Form.Item>\n\n          <Form.Item name=\"track_index\" label=\"轨道号\">\n            <Input type=\"number\" placeholder=\"请输入轨道号\" />\n          </Form.Item>\n\n          <Form.Item name=\"position\" label=\"位置\">\n            <Input type=\"number\" placeholder=\"请输入位置(厘米)\" />\n          </Form.Item>\n\n          <Form.Item name=\"mile\" label=\"里程\">\n            <Input placeholder=\"请输入里程\" />\n          </Form.Item>\n\n          <Form.Item name=\"remark\" label=\"备注\">\n            <TextArea\n              autoSize={{ minRows: 3, maxRows: 5 }}\n              placeholder=\"请输入备注\"\n            />\n          </Form.Item>\n\n          <Form.Item name=\"images\" label=\"图片\">\n            <ImageUploader\n              value={fileList}\n              onChange={this.changeFileList}\n              upload={this.uploadFile}\n            />\n          </Form.Item>\n        </Form>\n\n        <Loading visible={loading} />\n      </>\n    );\n  }\n}\n\nexport default withRouter(TaskEdit);\n","import Home from './pages/Home';\nimport TaskEdit from './pages/TaskEdit';\nconst routes = [\n  {\n    key: 'Home',\n    path: '/',\n    component: Home,\n    exact: true,\n  },\n  {\n    key: 'TaskEdit',\n    path: '/task/:objectId',\n    component: TaskEdit,\n  },\n];\n\nexport default routes;\n","import AV from 'leancloud-storage/live-query';\nimport { Route } from 'react-router-dom';\nimport './App.css';\nimport routes from './routes';\n\nAV.init({\n  appId: 'D2Lp5opsBuU0pViwGNsM9I88-gzGzoHsz',\n  appKey: 'sTjoMU6UUPTSV127KrTJcC0Q',\n  serverURL: 'https://d2lp5ops.lc-cn-n1-shared.com',\n});\n\nfunction App() {\n  return (\n    <>\n      {routes.map((route) => (\n        <Route\n          key={route.key}\n          path={route.path}\n          component={route.component}\n          exact={route.exact}\n        ></Route>\n      ))}\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport App from './App';\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}